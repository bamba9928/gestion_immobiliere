{% extends "base.html" %}
{% load static %}

{% block title %}Mes Documents | MADA IMMO{% endblock %}

{% block content %}
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 space-y-8">

    <div class="border-b border-neutral-800 pb-6">
        <h1 class="text-3xl font-black text-white tracking-tight">Espace Documents</h1>
        <p class="text-neutral-400 mt-2">Retrouvez l'historique de tous vos documents contractuels et comptables.</p>
    </div>

    <section>
        <h2 class="text-xl font-bold text-white mb-4 flex items-center gap-2">
            <svg class="w-5 h-5 text-emerald-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/></svg>
            Contrats de Bail
        </h2>
        {% if baux %}
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-4">
                {% for bail in baux %}
                <div class="bg-neutral-900 border border-neutral-800 rounded-xl p-4 hover:border-emerald-500/50 transition-all">
                    <div class="flex justify-between items-start mb-2">
                        <span class="text-xs font-bold text-neutral-500 uppercase">{{ bail.date_debut|date:"d/m/Y" }}</span>
                        <span class="px-2 py-0.5 text-[10px] rounded bg-emerald-500/10 text-emerald-400 border border-emerald-500/20">Actif</span>
                    </div>
                    <h3 class="font-bold text-white mb-1">{{ bail.bien.titre }}</h3>
                    <p class="text-sm text-neutral-400 mb-4">Locataire : {{ bail.locataire.get_full_name }}</p>
                    <a href="{{ bail.fichier_contrat.url }}" target="_blank" class="w-full flex items-center justify-center gap-2 px-4 py-2 rounded-lg bg-neutral-800 hover:bg-neutral-700 text-sm font-medium text-white transition-colors">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"/></svg>
                        Télécharger PDF
                    </a>
                </div>
                {% endfor %}
            </div>
        {% else %}
            <p class="text-neutral-500 text-sm italic">Aucun contrat disponible.</p>
        {% endif %}
    </section>

    <section>
        <h2 class="text-xl font-bold text-white mb-4 flex items-center gap-2">
            <svg class="w-5 h-5 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"/></svg>
            Quittances de Loyer
        </h2>
        {% if quittances %}
            <div class="bg-neutral-900 border border-neutral-800 rounded-xl overflow-hidden">
                <table class="w-full text-sm text-left text-neutral-300">
                    <thead class="bg-neutral-950 text-neutral-500 text-xs uppercase font-bold">
                        <tr>
                            <th class="px-6 py-3">Période</th>
                            <th class="px-6 py-3">Bien / Locataire</th>
                            <th class="px-6 py-3 text-right">Montant</th>
                            <th class="px-6 py-3 text-right">Action</th>
                        </tr>
                    </thead>
                    <tbody class="divide-y divide-neutral-800">
                        {% for q in quittances %}
                        <tr class="hover:bg-neutral-800/50">
                            <td class="px-6 py-3 font-medium text-white">{{ q.periode_debut|date:"F Y"|title }}</td>
                            <td class="px-6 py-3">
                                {{ q.bail.bien.titre }} <br>
                                <span class="text-xs text-neutral-500">{{ q.bail.locataire.get_full_name }}</span>
                            </td>
                            <td class="px-6 py-3 text-right font-mono">{{ q.montant_verse }} FCFA</td>
                            <td class="px-6 py-3 text-right">
                                <a href="{% url 'download_quittance' q.id %}" class="text-blue-400 hover:text-blue-300 hover:underline">Télécharger</a>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        {% else %}
            <p class="text-neutral-500 text-sm italic">Aucune quittance disponible.</p>
        {% endif %}
    </section>

</div>
{% endblock %}